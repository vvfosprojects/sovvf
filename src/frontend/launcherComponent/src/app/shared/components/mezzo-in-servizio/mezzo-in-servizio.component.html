<div class="border rounded px-3 py-2 h-100 font-xxlarge bg-mezzo-in-servizio d-flex align-items-center justify-content-between"
     [class.bg-mezzo-in-servizio-selezionato]="idMezzoInServizioSelezionato === mezzoInServizio.mezzo.mezzo.codice"
     [ngClass]="cardClasses(mezzoInServizio.mezzo.mezzo.stato)"
     style="min-height: 62px"
     (mouseenter)="hoverIn.emit(mezzoInServizio.mezzo.mezzo.codice)"
     (mouseleave)="hoverOut.emit()"
     (click)="selezionato.emit(mezzoInServizio.mezzo.mezzo.codice)">
    <ng-template [ngIf]="loadingArray.includes(mezzoInServizio.mezzo.mezzo.codice)">
        <app-partial-loader></app-partial-loader>
    </ng-template>
    <div class="d-flex align-items-center justify-content-between">
        <!-- Mezzo -->
        <div class="mr-4">
            <app-mezzo [mezzo]="mezzoInServizio.mezzo.mezzo"
                       [mezzoInServizioPage]="true"
                       [actionsAttive]="mezzoInServizio.mezzo.mezzo.stato !== StatoMezzo.InSede"
                       (actionMezzo)="actionMezzo.emit({'a': mezzoInServizio.mezzo.mezzo, 'b': $event})">
            </app-mezzo>
        </div>
        <!-- Squadra/e sul Mezzo -->
        <ng-container *ngIf="mezzoInServizio?.squadre?.length">
            <div class="d-flex align-items-center justify-content-end font-weight-bold">
                <div>
                    <i class="fas fa-users text-{{statoMezzoColor(mezzoInServizio.mezzo.mezzo.stato)}}"></i>
                </div>
                <div class="mx-2"
                     ngbTooltip="{{mezzoInServizio.squadre[0].nome}}"
                     [disableTooltip]="mezzoInServizio.squadre[0].nome.length <= 6">
                    {{ mezzoInServizio.squadre[0].nome | truncate: 6}}
                </div>
                <button class="btn btn-sm btn-no-hover btn-light border ml-1" ngbTooltip="Elenco squadre"
                        (click)="onListaSquadrePartenza(); $event.stopPropagation()">
                    <div *ngIf="mezzoInServizio.squadre?.length"
                         class="d-inline-block">
                        <i class="fas fa-search"
                           [class.mr-1]="mezzoInServizio.squadre.length > 1"></i>
                        <div *ngIf="mezzoInServizio.squadre.length > 1"
                             class="d-inline-block">
                            +{{ mezzoInServizio.squadre.length - 1 }}
                        </div>
                    </div>
                </button>
            </div>
        </ng-container>
    </div>
    <!-- Indirizzo -->
    <ng-container *ngIf="mezzoInServizio.mezzo.infoRichiesta?.indirizzo">
        <div class="d-flex align-items-center"
             [ngbTooltip]="mezzoInServizio.mezzo.infoRichiesta.indirizzo"
             [disableTooltip]="mezzoInServizio.mezzo.infoRichiesta.indirizzo.length < truncateLenghtIndirizzoRichiesta">
            <div class="mr-2">
                <i class="fas fa-fw fa-map-marker-alt text-{{statoMezzoColor(mezzoInServizio.mezzo.mezzo.stato)}}"></i>
            </div>
            <div>
                {{ mezzoInServizio.mezzo.infoRichiesta.indirizzo | truncate: truncateLenghtIndirizzoRichiesta }}
            </div>
        </div>
    </ng-container>
    <div class="d-flex align-items-center justify-content-end">
        <!-- Codice Richiesta -->
        <ng-container *ngIf="!hideCodRichiesta">
            <div class="mr-2">
                <button *ngIf="mezzoInServizio.mezzo.infoRichiesta?.codiceRichiesta"
                        class="btn btn-no-hover btn-light font-weight-bold"
                        (click)="dettaglioRichiesta.emit(mezzoInServizio.mezzo.mezzo.idRichiesta)">
                    <i class="fas fa-hashtag"></i>
                    {{ mezzoInServizio.mezzo.infoRichiesta.codiceRichiesta }}
                </button>
            </div>
        </ng-container>
        <!-- Tipologia Richiesta  -->
        <ng-container *ngIf="showTipologiaRichiesta">
            <div class="mr-2">
                <div [ngbTooltip]="richiesta?.tipologie[0]?.descrizione"
                     [disableTooltip]="richiesta?.tipologie[0]?.descrizione.length < 23">
                    <i class="fa-fw mr-1 {{ methods.coloraIcona(richiesta?.tipologie[0]) }}"></i>
                    {{ richiesta?.tipologie[0]?.descrizione | truncate: 23 }}
                </div>
            </div>
        </ng-container>
        <!-- Eventi -->
        <ng-container *ngIf="mezzoInServizio.mezzo.mezzo.idRichiesta">
            <div class="mr-2">
                <button class="btn btn-block btn-no-hover btn-light"
                        [ngbTooltip]="'Visualizza Eventi'"
                        [disableTooltip]="!hideTextButtonEventi"
                        (click)="visualizzaEventiRichiesta.emit(mezzoInServizio.mezzo.mezzo)">
                    <i class="fas fa-list"></i>
                    <ng-container *ngIf="!hideTextButtonEventi">
                        Eventi
                    </ng-container>
                </button>
            </div>
        </ng-container>
        <!-- Distaccamento -->
        <ng-container *ngIf="!hideDistaccamento">
            <div class="badge badge-secondary"
                 [class.mr-2]="showSelectButton"
                 [ngbTooltip]="mezzoInServizio.mezzo.mezzo.distaccamento.descrizione"
                 [disableTooltip]="mezzoInServizio.mezzo.mezzo.distaccamento.descrizione.length <= 13">
                {{ mezzoInServizio.mezzo.mezzo.distaccamento.descrizione | slice: 0:15 }}
            </div>
        </ng-container>
        <!-- Select Button -->
        <ng-container *ngIf="showSelectButton">
            <div class="">
                <button class="btn btn-block btn-light btn-no-hover border-secondary"
                        (click)="onSelect(mezzoInServizio)">
                    {{ 'info' | uppercase }}
                </button>
            </div>
        </ng-container>
    </div>
</div>
