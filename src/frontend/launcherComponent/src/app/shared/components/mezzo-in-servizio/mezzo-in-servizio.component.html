<div class="row border rounded shadow-sm p-2 h-100 font-xxlarge bg-mezzo-in-servizio"
     [class.bg-mezzo-in-servizio-selezionato]="idMezzoInServizioSelezionato === mezzoInServizio.mezzo.mezzo.codice"
     [ngClass]="cardClasses(mezzoInServizio.mezzo.mezzo.stato)"
     (mouseenter)="hoverIn.emit(mezzoInServizio.mezzo.mezzo.codice)"
     (mouseleave)="hoverOut.emit()"
     (click)="selezionato.emit(mezzoInServizio.mezzo.mezzo.codice)">
    <ng-template [ngIf]="loadingArray.includes(mezzoInServizio.mezzo.mezzo.codice)">
        <app-partial-loader></app-partial-loader>
    </ng-template>
    <div class="col-12" style="min-height: 45.6px">
        <div class="row">
            <div class="col-4">
                <div class="clearfix">
                    <!-- Mezzo -->
                    <div class="float-left" style="height:35px">
                        <app-mezzo [mezzo]="mezzoInServizio.mezzo.mezzo"
                                   [mezzoInServizioPage]="true"
                                   [actionsAttive]="mezzoInServizio.mezzo.mezzo.stato !== StatoMezzo.InSede"
                                   (actionMezzo)="actionMezzo.emit({'a': mezzoInServizio.mezzo.mezzo, 'b': $event})">
                        </app-mezzo>
                    </div>
                    <!-- Squadra/e sul Mezzo -->
                    <div class="float-right pt-1">
                        <div *ngIf="mezzoInServizio?.squadre?.length"
                             class="d-inline-block text-right mb-0 font-weight-bold">
                            <i class="fas fa-users text-{{statoMezzoColor(mezzoInServizio.mezzo.mezzo.stato)}} mr-1"></i>
                            <div class="d-inline-block"
                                 ngbTooltip="{{mezzoInServizio.squadre[0].nome}}"
                                 [disableTooltip]="mezzoInServizio.squadre[0].nome.length <= 6">
                                {{ mezzoInServizio.squadre[0].nome | truncate: 6}}
                            </div>
                            <button class="btn btn-sm btn-no-hover btn-light border ml-1" ngbTooltip="Elenco squadre"
                                    (click)="onListaSquadrePartenza(); $event.stopPropagation()">
                                <div *ngIf="mezzoInServizio.squadre?.length"
                                     class="d-inline-block">
                                    <i class="fas fa-search"
                                       [class.mr-1]="mezzoInServizio.squadre.length > 1"></i>
                                    <div *ngIf="mezzoInServizio.squadre.length > 1"
                                         class="d-inline-block">
                                        +{{ mezzoInServizio.squadre.length - 1 }}
                                    </div>
                                </div>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Indirizzo -->
            <div class="col-{{colIndirizzoRichiesta}} d-flex align-items-center">
                <ng-container *ngIf="mezzoInServizio.mezzo.infoRichiesta?.indirizzo">
                    <div [ngbTooltip]="mezzoInServizio.mezzo.infoRichiesta.indirizzo"
                         [disableTooltip]="mezzoInServizio.mezzo.infoRichiesta.indirizzo.length < truncateLenghtIndirizzoRichiesta">
                        <i class="fas fa-map-marker-alt text-{{statoMezzoColor(mezzoInServizio.mezzo.mezzo.stato)}}"></i>
                        {{ mezzoInServizio.mezzo.infoRichiesta.indirizzo | truncate: truncateLenghtIndirizzoRichiesta }}
                    </div>
                </ng-container>
            </div>
            <div class="col-{{colInfoRichiesta}} d-flex justify-content-between align-items-center">
                <!-- Codice Richiesta -->
                <ng-container *ngIf="!hideCodRichiesta">
                    <div class="float-left pr-3">
                        <button *ngIf="mezzoInServizio.mezzo.infoRichiesta?.codiceRichiesta"
                                class="btn btn-block btn-no-hover btn-light font-weight-bold"
                                (click)="dettaglioRichiesta.emit(mezzoInServizio.mezzo.mezzo.idRichiesta)">
                            <i class="fas fa-hashtag"></i>
                            {{ mezzoInServizio.mezzo.infoRichiesta.codiceRichiesta }}
                        </button>
                    </div>
                </ng-container>
                <!-- Tipologia Richiesta  -->
                <ng-container *ngIf="showTipologiaRichiesta">
                    <div class="float-left"
                         [ngbTooltip]="richiesta?.tipologie[0]?.descrizione"
                         [disableTooltip]="richiesta?.tipologie[0]?.descrizione.length < 23">
                        <i class="fa-fw mr-1 {{ methods.coloraIcona(richiesta?.tipologie[0]) }}"></i>
                        {{ richiesta?.tipologie[0]?.descrizione | truncate: 23 }}
                    </div>
                </ng-container>
                <!-- Eventi -->
                <div class="float-right">
                    <button *ngIf="mezzoInServizio.mezzo.mezzo.idRichiesta"
                            class="btn btn-block btn-no-hover btn-light"
                            [ngbTooltip]="'Visualizza Eventi'"
                            [disableTooltip]="!hideTextButtonEventi"
                            (click)="visualizzaEventiRichiesta.emit(mezzoInServizio.mezzo.mezzo)">
                        <i class="fas fa-list"></i>
                        <ng-container *ngIf="!hideTextButtonEventi">
                            Eventi
                        </ng-container>
                    </button>
                </div>
            </div>
            <!-- Distaccamento -->
            <ng-container *ngIf="!hideDistaccamento">
                <div class="col-2 px-0 text-right">
                    <div class="badge badge-secondary"
                         [ngbTooltip]="mezzoInServizio.mezzo.mezzo.distaccamento.descrizione"
                         [disableTooltip]="mezzoInServizio.mezzo.mezzo.distaccamento.descrizione.length <= 13">
                        {{ mezzoInServizio.mezzo.mezzo.distaccamento.descrizione | slice: 0:15 }}
                    </div>
                </div>
            </ng-container>
            <!-- Select Button -->
            <ng-container *ngIf="showSelectButton">
                <div class="col-1">
                    <button class="btn btn-block btn-light btn-no-hover border-secondary"
                            (click)="onSelect(mezzoInServizio)">
                        {{ 'info' | uppercase }}
                    </button>
                </div>
            </ng-container>
        </div>
    </div>
</div>
