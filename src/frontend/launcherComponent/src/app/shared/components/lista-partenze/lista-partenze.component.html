<div *ngIf="checkNumeroPartenzeAttive(partenze) <= 0">
    <div class="mt-1">Non sono presenti partenze.</div>
</div>
<ng-container *ngIf="checkNumeroPartenzeAttive(partenze) > 0">
    <div *ngFor="let p of partenze; let index = index">
        <div *ngIf="!p.partenza.sganciata && !p.partenza.partenzaAnnullata && !p.partenza.terminata"
             [class.border-bottom]="(index + 1) !== partenze.length">
            <app-partial-loader
                    *ngIf="loadingActionMezzo?.includes(p?.partenza?.mezzo?.codice)"></app-partial-loader>
            <app-partenza [codiceRichiesta]="codiceRichiesta"
                          [partenza]="p.partenza"
                          [codicePartenza]="p.codicePartenza"
                          [infoPartenza]="p"
                          [listaEventi]="listaEventi"
                          [inGestione]="inGestione"
                          [statoRichiesta]="statoRichiesta"
                          [idDaSganciare]="idDaSganciare"
                          [index]="'' + index"
                          [annullaStatoMezzo]="annullaStatoMezzi?.includes(p?.partenza?.mezzo?.codice)"
                          (listaSquadre)="onListaSquadrePartenza($event.codiceMezzo, $event.listaSquadre)"
                          (actionMezzo)="onActionMezzo($event)"
                          (eliminaPartenza)="eliminaPartenza.emit($event)"
                          (modificaPartenza)="modificaPartenza.emit($event)"
                          (selezioneMezzo)="selezioneMezzo.emit($event)">
            </app-partenza>
        </div>
    </div>
    <ng-template [ngIf]="inGestione && sostituzioneFineTurnoActive">
        <div class="d-inline-block"
             [ngbTooltip]="tooltipLockedConcorrenza"
             [disableTooltip]="!(tipoConcorrenzaEnum.Richiesta | checkConcorrenzaLocked: [codiceRichiesta])">
            <button class="btn btn-sm btn-info" ngbTooltip="Sostituzione Fine Turno"
                    style="position:absolute; top:-14px; left:-14px"
                    [disabled]="tipoConcorrenzaEnum.Richiesta | checkConcorrenzaLocked: [codiceRichiesta]"
                    [class.cursor-not-allowed]="tipoConcorrenzaEnum.Richiesta | checkConcorrenzaLocked: [codiceRichiesta]"
                    (click)="sostituzioneFineTurno.emit(); $event.stopPropagation()">
                <i class="fas fa-sync-alt"></i>
            </button>
        </div>
    </ng-template>
</ng-container>

<ng-template #tooltipLockedConcorrenza>
    <i class="fas fa-lock mr-1"></i>
    {{ tipoConcorrenzaEnum.Richiesta | checkConcorrenzaLocked: [codiceRichiesta] }}
</ng-template>
