<div class="row mt-2">
    <app-partial-loader *ngIf="loading"></app-partial-loader>
    <!-- Lista di singole Richieste -->
    <div *ngIf="richieste && richieste.length > 0" class="col-12 px-0" [ngClass]="heightControl()"
         style="overflow-x: hidden; overflow-y: auto">
        <div *ngFor="let r of richieste | paginate: { itemsPerPage: pageSize, currentPage: page, totalItems: totalItems }"
             class="col-12 test-hover">
            <div id="richiesta" *ngIf="!richiestaFissata || (r.id !== richiestaFissata.id)"
                 class="w-100 rounded card-shadow" [ngClass]="cardClasses(r)" style="border-top: solid thin #e0e0e0">
                <app-partial-loader *ngIf="actionRichiestaArray.includes(r.id)"></app-partial-loader>
                <app-sintesi-richiesta class="non-fissata"
                                       [richiesta]="r"
                                       [fissata]="false"
                                       [fissabile]="true"
                                       [boxAzioni]="true"
                                       [isEspanso]="isEspanso(r.id)"
                                       [espandibile]="true"
                                       [sostituzioneFineTurno]="true"
                                       [nightMode]="nightMode"
                                       [inGestione]="richiestaGestione?.id === r.id"
                                       [disabledModificaRichiesta]="permessiFeature.ModificaRichiesta | checkPermissionRichiesta: r.codUOCompetenza : r.codSOCompetente : r.codSOAllertate"
                                       [disabledGestisciRichiesta]="permessiFeature.GestisciRichiesta | checkPermissionRichiesta: r.codUOCompetenza : r.codSOCompetente : r.codSOAllertate"
                                       [disabledComposizionePartenza]="(permessiFeature.ComposizionePartenzaRichiesta | checkPermissionRichiesta: r.codUOCompetenza : r.codSOCompetente : r.codSOAllertate) || r.stato === statoRichiesta.Chiusa"
                                       [disableTooltips]="scrolling"
                                       [disableFissaInAlto]="richieste.length === 1"
                                       [loadingEliminaPartenza]="loadingEliminaPartenza"
                                       (hoverIn)="richiestaHoverIn($event)"
                                       (hoverOut)="richiestaHoverOut($event)"
                                       (fissaInAlto)="onFissaInAlto($event)"
                                       (clickRichiesta)="richiestaClick($event)"
                                       (doubleClickRichiesta)="richiestaDoubleClick($event)"
                                       (nuovaPartenza)="nuovaPartenza($event)"
                                       (eventiRichiesta)="visualizzaEventiRichiesta($event)"
                                       (modificaRichiesta)="onModificaRichiesta($event)"
                                       (gestioneRichiesta)="onGestioneRichiesta($event)"
                                       (actionMezzo)="actionMezzo.emit($event)"
                                       (actionRichiesta)="actionRichiesta.emit($event)"
                                       (outEspansoId)="outEspansoId.emit($event)"
                                       (eliminaPartenza)="eliminaPartenza.emit($event)"
                                       (modificaStatoFonogramma)="modificaStatoFonogramma.emit($event)"
                                       (allertaSede)="allertaSede.emit($event)">
                </app-sintesi-richiesta>
            </div>
        </div>
    </div>
    <ng-container *ngIf="!loading && richieste && richieste.length === 0">
        <div class="col-12 mt-3 text-center">
            <div class="row">
                <div class="col-6 mx-auto">
                    <div class="px-3 pt-3">
                        <img class="img-fluid rounded" src="assets/img/404-img.png"
                             alt="Spiacente, nessun risultato con i parametri di ricerca selezionati">
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-6 mx-auto" style="background-color: #475773">
                    <div class="p-3">
                        <span class="font-weight-bolder text-white">{{'Spiacente, nessun risultato con i parametri di ricerca selezionati' | uppercase}}</span>
                    </div>
                </div>
            </div>
        </div>
    </ng-container>
    <div *ngIf="richieste && richieste?.length" class="col-12 mt-1">
        <div class="row">
            <div class="col-4">
                <button class="btn btn-block btn-no-hover font-xlarge"
                        [ngClass]="{'btn-outline-primary': !needRefresh, 'btn-primary': needRefresh}"
                        [disabled]="!needRefresh || loading" (click)="refresh.emit(true)">
                    <ng-template [ngIf]="needRefresh && !loading">
                        <i class="fa fa-refresh mr-1"></i>
                        <span class="font-weight-bold">
                            Aggiornamento Richiesto
                        </span>
                    </ng-template>
                    <ng-template [ngIf]="!needRefresh && !loading">
                        <i class="fa fa-check mr-1"></i>
                        La lista Ã¨ aggiornata
                    </ng-template>
                    <ng-template [ngIf]="loading">
                        <i class="fa fa-refresh fa-spin mr-1"></i>
                        Caricamento...
                    </ng-template>
                </button>
            </div>
            <div class="col-8 text-right pt-1">
                <pagination-controls class="mb-0"
                                     [previousLabel]="'Precedente'"
                                     [nextLabel]="'Successiva'"
                                     (pageChange)="pageChange.emit($event)">
                </pagination-controls>
            </div>
        </div>
    </div>
</div>
